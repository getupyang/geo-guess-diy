
# GeoGuesser - 产品需求文档 (PRD)

## 1. 产品概述
**GeoGuesser** 是一款基于地理位置的探索与猜谜游戏。用户通过上传照片创建挑战，或参与他人发起的挑战，根据图片中的视觉线索（如植被、建筑、路牌）在地图上猜测具体位置。

### 1.1 核心价值
- **探索欲**：足不出户，通过图片探索世界各地的角落。
- **社交互动**：创建谜题挑战好友，复盘对比各自的猜测结果。
- **轻量级**：Web 端即开即玩，无需下载 App。

## 2. 用户角色
- **出题者 (Creator)**：上传图片，设置目标地点，发布挑战。
- **猜题者 (Player)**：浏览挑战，通过地图交互进行猜测。

## 3. 功能模块

### 3.1 首页 (Home)
- **用户信息**：展示当前用户头像、昵称、ID。支持点击修改昵称。
- **开始挑战**：随机抽取一个用户未玩过的挑战。
- **创建挑战**：入口跳转至创建流程。
- **最近挑战**：展示最近游玩的 2 条记录（图片缩略图+地点+分数）。
- **历史记录**：点击“查看更多”进入完整历史列表。

### 3.2 创建挑战 (Create Mode)
1.  **图片上传**：支持本地上传（自动提取 EXIF GPS 信息）。
2.  **图片处理**：
    -   **压缩**：自动压缩至 1024px / 0.6 质量，保证加载速度。
    -   **打码**：支持“马赛克”涂抹功能，隐藏关键信息（如路牌文字），支持撤销。
3.  **位置设定**：
    -   自动读取 GPS（如有）。
    -   支持通过地图搜索地址（Geocoding）。
    -   支持在地图上拖拽修正位置。
    -   反显具体地理位置名称（如“北京市故宫博物院”）。
4.  **发布**：保存至云端数据库。 

### 3.3 游玩挑战 (Play Mode)
1.  **图片浏览**：全屏展示挑战图片，支持**双指缩放**、**双击放大**、**拖拽平移**查看细节。
2.  **地图猜测**：
    -   点击浮动按钮唤起地图。
    -   地图支持缩放、平移。
    -   用户点击选点，确认后提交。

### 3.4 结果复盘 (Review Mode)
1.  **结果可视化**：
    -   地图上同时显示：**正确答案**（旗帜）、**我的猜测**（头像+连线）、**其他玩家猜测**（头像+气泡）。
    -   点击右下角按钮可反复开关地图，查看图片细节。
2.  **数据展示**：
    -   顶部显示本次得分（0-5000）和**误差距离**（m/km）。
    -   **群体统计**：当参与玩家超过 2 人时，显示全服平均分和总挑战人数。
3.  **反馈机制**：
    -   提供 **👍 点赞** 和 **👎 报错/不喜欢** 按钮。用户可对题目质量进行反馈。

## 4. 关键交互细节
- **地图防误触**：地图面板增加全屏透明遮罩，点击遮罩或关闭按钮才收起，防止误触。
- **手势支持**：移动端完美支持 Pinch-to-zoom 和 Touch 拖拽。
- **无缝衔接**：利用本地缓存，减少等待时间。

## 5. 性能指标
- **首屏加载**：< 1.5秒
- **图片加载**：< 300ms (基于 100KB 压缩图)
- **地图渲染**：无闪退，支持 ResizeObserver 响应式调整。